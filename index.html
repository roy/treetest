<html>
<head>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/prototype/1.7.0.0/prototype.js"></script>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/scriptaculous/1.8.3/scriptaculous.js"></script>
  <script src="js/sortable_tree.js" type="text/javascript"></script>    

  <!--
  <script src="vendor/prototype.js" type="text/javascript"></script>
  <script src="vendor/effects.js" type="text/javascript"></script>
  <script src="vendor/dragdrop.js" type="text/javascript"></script>    
  <script src="js/sortable_tree.js" type="text/javascript"></script>    
  -->
  <link rel="stylesheet" type="text/css" href="css/application.css" media="screen" /> 
</head>
<body>
<ul id="tree" class="tree">
  <li id="node_1">
    <span class="handle"></span>
    <a>node 1</a>
    <ul>
      <li id="node_11">
        <span class="handle"></span>
        <a>node 11</a>
        <ul>
          <li id="node_111" class="file"><a>node 111</a></li>
          <li id="node_112" class="file"><a>node 112</a></li>
          <li id="node_113" class="file"><a>node 113</a></li>
        </ul>            
      </li>
      <li id="node_12" class="file"><a>node 12</a></li>
      <li id="node_13" class="file"><a>node 13</a></li>
    </ul>
  </li>
  <li id="node_2">
    <span class="handle"></span>
    <a>node 2</a>
    <ul>
      <li id="node_21" class="file"><a>node 21</a></li>
      <li id="node_22" class="file"><a>node 22</a></li>
      <li id="node_23" class="file"><a>node 23</a></li>
    </ul>              
  </li>
</ul>
<ul id="tree2" class="tree">
  <li id="node_91">
    <span class="handle"></span>
    <a>node9 1</a>
    <ul>
      <li id="node_911">
        <span class="handle"></span>
        <a>node 911</a>
        <ul>
          <li id="node_9111" class="file"><a>node 9111</a></li>
          <li id="node_9112" class="file"><a>node 9112</a></li>
          <li id="node_9113" class="file"><a>node 9113</a></li>
        </ul>            
      </li>
      <li id="node_912" class="file"><a>node 912</a></li>
      <li id="node_913" class="file"><a>node 913</a></li>
    </ul>
  </li>
  <li id="node_92">
    <span class="handle"></span>
    <a>node 2</a>
    <ul>
      <li id="node_921" class="file"><a>node 921</a></li>
      <li id="node_922" class="file"><a>node 922</a></li>
      <li id="node_923" class="file"><a>node 923</a></li>
    </ul>              
  </li>
</ul>
<div id="log"></div>

<script>
  var tree = new SortableTree('tree', {
    droppable: {
    },
    onDrop: function(drag, drop, event){
      $('log').update($('log').innerHTML + "<p>" + drag.to_params() + "</p>")
    }
  });
  var tree2 = new SortableTree('tree2', {
    droppable: {
    },
    onDrop: function(drag, drop, event){
      $('log').update($('log').innerHTML + "<p>" + drag.to_params() + "</p>")
    }
  });
  tree.setSortable();
  tree2.setSortable();

  function log(line) {
    $('log').update($('log').innerHTML + "<p>" + line + "</p>");
  }
  
  function toggle_folder(event) {
    var element = event.element().ancestors().first();
    if(element.hasClassName('closed')) {
      element.removeClassName('closed');
    } else {
      element.addClassName('closed');
    }
  }
  
  Event.observe(window, "load", function(){
    $$('.handle').each(function(element){
      Event.observe(element, 'click', toggle_folder);
    });
  });
</script>
 
</body>
</html>
